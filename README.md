# ASUS-FX504GE-Hackintosh
Discussion, necessary configuration and instructions to get [this ASUS TUF FX504GE laptop](https://www.ultrabookreview.com/19725-asus-tuf-fx504ge-review/) working with macOS Mojave 10.14. The following should also work with all ASUS FX504G.. laptop variants.

# Notes
1. 128 GB NVMe SSD is used for installing macOS
2. APFS partition format has to be used
3. If you are upgrading from the previous version and your partition is HFS+, better boot the installer, unmount the partition and convert it to APFS

# Pre-installation
Get yourself a Mojave USB installer with Clover installed. Important Clover settings (via Clover Configurator) are:
1. Boot: flags: `dart=0 -no_compat_check`
2. CPU: `QPI=100`
3. Graphics: Inject `Intel=Yes`
4. SMBIOS: MacBookPro15,2
5. UEFI Drivers: **EmuVariableUefi-64**, **ApfsDriverLoader-64**, **PartitionDxe-64**, CsmVideoDxe64, OsxAptioFixDrv-64, UsbKbDxe-64, UsbMouseDxe-64, NvmExpressDxe-64.efi, HFSPlus-64
 
Kexts installed to `/EFI/CLOVER/kexts`: **FakeSMC**, **VoodooPS2Controller**

# BIOS Settings
1. Intel Virtualization Technology & VT-d: Disabled
2. Fast Boot & Secure Boot: Disabled
3. SATA mode: AHCI
4. DVMT-Preallocated: 64MB

# Post Configuration
Any changes made to kexts are to be followed by `sudo kextcache -i /`.
Every external kext mentioned is assumed to be the latest.
## First Step
1. Lilu and FakeSMC kexts installed to `/Library/Extensions`
2. DSDT files generated by Clover to the EFI partition
## CPU Power Management
1. Clover ACPI `PluginType` enabled
2. Clover Kernel Patches `Kernel LAPIC`, `KernelPM` and `AppleRTC` enabled
3. ACPIBatteryManager kext installed to `/Library/Extensions`
## ALC255 Audio
Internal speaker and microphone work. For Headphone output, volume balance has to be either left or right to make the sound normal.
1. `/System/Library/Extensions/AppleGFXHDA.kext` must be removed
2. AppleALC kext installed to `/Library/Extensions`
3. Clover Audio injection `Inject=3`
## PS/2 Keyboard
1. VoodooPS2Controller kext installed to `/Library/Extensions`
2. Karabiner (to remap your keyboard)
## Intel UHD 630 Graphics
1. Clover Intel graphics `Inject=true`
2. WhateverGreen kext (with CFL backlight fix) installed to `/Library/Extensions`
### Backlight Control
Somewhat works. There may be a 3-minutes lowest backlight level bug at boot.
1. AppleBacklightFixup kext installed to `/Library/Extensions`
2. `SSDT-PNLF.aml` installed to `/EFI/Clover/ACPI/patched`
3. Clover flag added for WhateverGreen: `igfxcflbklt=freq`
## USB 2.0/3.1 Ports
1. Clover USB injection `Inject=false`
2. USBInjectAll and XHCI-300-series-injector kexts installed to `/Library/Extensions`
3. TODO: Edit `SSDT-UIAC.aml` to match available ports
## Realtek LAN
1. RTL8111 kext installed to `/Library/Extensions`
## SATA controller
1. SATA-300-series-unsupported kext installed to `/Library/Extensions`
## Miscellaneous
1. NoTouchID kext installed to `/Library/Extensions` (MacBookPro15,2 has Touch ID)

# Things that do not work
## NVIDIA Geforce 1050 Ti (Optimus)
Discrete graphic, we probably never see the day.
## Intel HDMI Port
No HDMI output. Once the cable is plugged, the system lags for a couple of seconds.
## Intel Wi-Fi AC 9560
Intel built-in Wi-Fi chipset, we again probably never see the day.
## I2C ELAN1200 Precision TouchPad
VoodooI2C does not work with it, yet.
## Sleep and Wake
No deep sleep support.

![Screenshot](FX504GE-SS.png?raw=true)
